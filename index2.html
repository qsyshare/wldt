<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>可筛选的多列列表</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            margin: 0;
        }
        h5 {
            text-align: center;
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 1000;
            padding: 10px;
            margin: 0;
        }
        #searchInput, #filterSelect {
            width: 100%;
            padding: 12px;
            margin-bottom: 5px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            position: sticky;
            top: 50px;
            background-color: white;
            z-index: 1000;
        }
        #filterSelect {
            width: 160px;
            margin-top: -10px;
            top: 100px;
            background-color: navajowhite;
        }
        table {
            width: 100%;
            max-width: 100vw; /* 表格最大宽度为视口宽度 */
            table-layout: fixed; /* 固定列宽 */
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 4px;
            text-align: center;
            word-wrap: break-word; /* 强制内容换行 */
        }
        th {
            background-color: #f4f4f4;
            position: sticky;
            top: 150px;
            z-index: 500;
        }
        /* 特定为 NO. 列设置的宽度 */
        th.no-column, td.no-column {
            width: 40px; /* 可以根据需要调整宽度 */
        }
          th.no-column1, td.no-column1 {
            width: 100px; /* 可以根据需要调整宽度 */
        }
          th.no-column2, td.no-column2 {
            
        }
          th.no-column3, td.no-column3 {
           
        }
          th.no-column4, td.no-column4 {
            width: 120px; /* 可以根据需要调整宽度 */
        }
          th.no-column5, td.no-column5 {
            width: 80px; /* 可以根据需要调整宽度 */
        }
          th.no-column6, td.no-column6 {
            width: 80px; /* 可以根据需要调整宽度 */
        }
       

        .action-buttons a {
            margin-right: 10px;
            text-decoration: none;
            color: blue;
        }
    </style>

    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "4c0a6a67417444aa9f8f8b507aad5f96"}'></script>
    <!-- End Cloudflare Web Analytics -->

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VW62L5RT2K"></script>
    
</head>
<body>

    <h5>网络地图------广告位招商</h5>

    <!-- 搜索框 -->
    <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="输入关键词进行筛选...">

    <!-- 选择框 -->
    <select id="filterSelect" onchange="filterTable()">
        <option value="all">全部列</option>
        <option value="tags">标签列</option>
        <option value="domestic">国内访问Y/N列</option>
    </select>

    <!-- 表格 -->
    <table id="dataTable">
        <thead>
            <tr>
                <th class="no-column">NO.</th> <!-- 为 NO. 列添加 class -->
                <th class="no-column1">名称</th>
                <th class="no-column2">网址</th>
                <th class="no-column3">说明</th>
                <th class="no-column4">标签</th>
                <th class="no-column5">国内访问Y/N</th>
                <th class="no-column6">记录日期</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- 数据将通过JavaScript加载 -->
        </tbody>
    </table>

    <br>
    <a href=""></a> <!-- 链接到管理页面 -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        // 从CSV文件加载数据
        async function loadCSV() {
            const response = await fetch('./wldt_cn1.csv');
            const csvText = await response.text();
            return new Promise((resolve, reject) => {
                Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    complete: results => resolve(results.data),
                    error: err => reject(err)
                });
            });
        }

        // 显示数据到表格，并自动添加NO.列
        async function displayData(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = ""; // 清空表格

            data.forEach((item, index) => {
                const row = document.createElement('tr');

                // 自动添加NO.列
                row.innerHTML = `
                    <td class="no-column">${index + 1}</td> <!-- NO.列有特定的class -->
                    <td class="no-column1">${item.名称 || ''}</td>
                    <td class="no-column2"><a href="${item.网址 || '#'}" target="_blank">${item.网址 || ''}</a></td>
                    <td class="no-column3">${item.说明 || ''}</td>
                    <td class="no-column4">${item.标签 || ''}</td>
                    <td class="no-column5">${item["国内访问Y/N"] || ''}</td>
                    <td class="no-column6">${item.记录日期 || ''}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // 筛选表格函数
        async function filterTable() {
            const input = document.getElementById("searchInput");
            const filter = input.value.toLowerCase();
            const filterType = document.getElementById("filterSelect").value;
            const data = await loadCSV();

            let filteredData = data.filter(item => {
                if (filterType === "all") {
                    return Object.values(item).some(value =>
                        String(value).toLowerCase().includes(filter)
                    );
                } else if (filterType === "tags") {
                    return item.标签.toLowerCase().includes(filter);
                } else if (filterType === "domestic") {
                    return item["国内访问Y/N"].toLowerCase().includes(filter);
                }
                return false;
            });

            displayData(filteredData);
        }

        // 初始化页面
        window.onload = async function() {
            const data = await loadCSV();
            displayData(data);
        }
    </script>

</body>
</html>
